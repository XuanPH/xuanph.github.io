__NUXT_JSONP__("/fr/dung-nginx-tren-docker-swarm-va-script-de-tao-va-gia-han-ssl-tren-docker-swarm-eW65G4jPKDO", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U){return {data:[{post:{slug:q,title:"D√πng Nginx tr√™n docker swarm v√† script ƒë·ªÉ t·∫°o v√† gia h·∫°n ssl tr√™n docker swarm",publishedAt:"2021-08-11 01:24",authors:[{name:"Nham Van Hung",avatarUrl:"https:\u002F\u002Fimages.viblo.asia\u002Favatar\u002F41794475-ead7-4edd-9917-7d8d35dabdb5.jpg",link:"https:\u002F\u002Fviblo.asia\u002Fu\u002Fnham.van.hung"}],tags:["Docker","Docker swarm","Nginx","Viblo"],private:false,source_post:"https:\u002F\u002Fviblo.asia\u002Fp\u002Fdung-nginx-tren-docker-swarm-va-script-de-tao-va-gia-han-ssl-tren-docker-swarm-eW65G4jPKDO",toc:[{id:B,depth:r,text:C},{id:D,depth:r,text:E},{id:F,depth:n,text:G},{id:H,depth:n,text:I},{id:J,depth:n,text:K},{id:L,depth:n,text:M},{id:N,depth:n,text:O},{id:P,depth:r,text:Q}],body:{type:"root",children:[{type:b,tag:s,props:{id:B},children:[{type:b,tag:e,props:{href:"#1-m%E1%BB%9F-%C4%91%E1%BA%A7u",ariaHidden:g,tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:C}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:"Nh∆∞ b√†i vi·∫øt tr∆∞·ªõc m√¨nh ƒë√£ gi·ªõi thi·ªáu v·ªõi c√°c b·∫°n v·ªÅ docker swarm, gluster, swarmpit.\nB√†i bi·∫øt n√†y m√¨nh s·∫Ω tri·ªÉn khai Nginx tr√™n c·ª•m swarm v√† script ƒë·ªÉ t·∫°o v√† gia h·∫°n ssl tr√™n c·ª•m swarm c·ªßa m√¨nh nh√©.\nC√°i n√†y r·∫•t th√≠ch h·ª£p cho c√°c b·∫°n tri·ªÉn khai nhi·ªÅu domain tr√™n c√πng 1 c·ª•m swarm."}]},{type:a,value:c},{type:b,tag:s,props:{id:D},children:[{type:b,tag:e,props:{href:"#2-n%C3%A0o-ch%C3%BAng-ta-c%C3%B9ng-b%E1%BA%AFt-%C4%91%E1%BA%A7u",ariaHidden:g,tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:E}]},{type:a,value:c},{type:b,tag:o,props:{id:F},children:[{type:b,tag:e,props:{href:"#21-tr%E1%BB%8F-domain-v%E1%BB%81-ip-c%E1%BB%A7a-3-server-trong-c%E1%BB%A5m-swarm",ariaHidden:g,tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:G}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:"C√°i n√†y th√¨ m√¨nh s·∫Ω kh√¥ng vi·∫øt. C√°c b·∫°n ch·ªâ c·∫ßn l√™n giao di·ªán qu·∫£n l√Ω domain v√† th·ª±c hi·ªán thao t√°c tr·ªè IP l√† ƒë∆∞·ª£c."}]},{type:a,value:c},{type:b,tag:o,props:{id:H},children:[{type:b,tag:e,props:{href:"#22-t%E1%BA%A1o-container-nginx-tr%C3%AAn-docker-swarm",ariaHidden:g,tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:I}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:"ƒê·∫ßu ti√™n ch√∫ng ta c·∫ßn t·∫°o container Nginx.\nCh√∫ng ta ƒëƒÉng nh·∫≠p v√†o giao di·ªán qu·∫£n l√Ω c·ª•m swarm theo link "},{type:b,tag:e,props:{href:R,rel:["nofollow","noopener","noreferrer"],target:"_blank"},children:[{type:a,value:R}]},{type:a,value:" nh∆∞ b√†i tr∆∞·ªõc\nm√¨nh ƒë√£ l√†m.\nCh·ªçn "},{type:b,tag:d,props:{},children:[{type:a,value:"Stacks"}]},{type:a,value:" =\u003E "},{type:b,tag:d,props:{},children:[{type:a,value:"New Stack"}]},{type:a,value:" sau ƒë√≥ ch√∫ng ta ƒëi·ªÅn nh∆∞ h√¨nh:\n"},{type:b,tag:f,props:{alt:l,src:"https:\u002F\u002Fimages.viblo.asia\u002F18572430-e7e5-4d93-b629-caf2334ab82d.png"},children:[]}]},{type:a,value:c},{type:b,tag:t,props:{className:[u]},children:[{type:b,tag:v,props:{className:[w,x]},children:[{type:b,tag:y,props:{},children:[{type:a,value:"version: '3.3'\nservices:\nnginx:\nimage: nginx:stable\nvolumes:\n- \u002Fmnt\u002Fdata\u002Fceph\u002Fletsencrypt\u002Fdata\u002F:\u002Fdata\u002Fletsencrypt\u002F\n- \u002Fmnt\u002Fdata\u002Fceph\u002Fletsencrypt\u002Fetc\u002F:\u002Fetc\u002Fletsencrypt\u002F\n- \u002Fmnt\u002Fdata\u002Fceph\u002Fnginx\u002Fetc\u002F:\u002Fetc\u002Fnginx\u002F\n- \u002Fmnt\u002Fdata\u002Fwww\u002F:\u002Fwww\nnetworks:\n- host\nlogging:\ndriver: json-file\ndeploy:\nmode: global\nnetworks:\nhost:\nexternal: true\n\n"}]}]}]},{type:a,value:c},{type:b,tag:z,props:{},children:[{type:a,value:c},{type:b,tag:p,props:{},children:[{type:a,value:"·ªû ƒë√¢y ch√∫ng ta mount volumes ƒë·ªÉ l·∫•y file c·∫•u h√¨nh ssl v√† c·∫•u h√¨nh nginx l·∫ßn l∆∞·ª£t l√† "},{type:b,tag:d,props:{},children:[{type:a,value:S}]},{type:a,value:T},{type:b,tag:d,props:{},children:[{type:a,value:A}]}]},{type:a,value:c},{type:b,tag:p,props:{},children:[{type:a,value:"Th∆∞ m·ª•c ch·ª©a c√°c file frontend l√† "},{type:b,tag:d,props:{},children:[{type:a,value:"\u002Fmnt\u002Fdata\u002Fwww"}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:o,props:{id:J},children:[{type:b,tag:e,props:{href:"#23-t%E1%BA%A1o-file-c%E1%BA%A5u-h%C3%ACnh-nginx",ariaHidden:g,tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:K}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:"ƒêƒÉng nh·∫≠p v√†o 1 trong 3 server trong c·ª•m swarm\nT·∫°o ƒë∆∞·ªùng d·∫´n "},{type:b,tag:d,props:{},children:[{type:a,value:S}]},{type:a,value:T},{type:b,tag:d,props:{},children:[{type:a,value:A}]},{type:b,tag:f,props:{alt:l,src:"https:\u002F\u002Fimages.viblo.asia\u002F447aef19-1bdd-4a43-8f37-151ac5314a0d.png"},children:[]},{type:b,tag:f,props:{alt:l,src:"https:\u002F\u002Fimages.viblo.asia\u002Fd7af74d1-1cea-4e55-965d-ceb13927af1c.png"},children:[]},{type:a,value:"\nC√°c file trong th∆∞ m·ª•c "},{type:b,tag:d,props:{},children:[{type:a,value:A}]},{type:a,value:" nh∆∞ 1 c·∫•u h√¨nh nginx b√¨nh th∆∞·ªùng c√°c b·∫°n c√≥ th·ªÉ c√†i nginx r·ªìi coppy\nl√™n server .\n·ªû ƒë√¢y ta ch·ªâ ch√∫ √Ω ƒë·∫øn file nginx.conf v√† th∆∞ m·ª•c conf.d ch·ª©a c√°c file c·∫•u h√¨nh cho t·ª´ng domain\nFile nginx.conf\n"},{type:b,tag:f,props:{alt:l,src:"https:\u002F\u002Fimages.viblo.asia\u002F5d10e318-8150-4a6c-a747-9444dd306400.png"},children:[]}]},{type:a,value:c},{type:b,tag:t,props:{className:[u]},children:[{type:b,tag:v,props:{className:[w,x]},children:[{type:b,tag:y,props:{},children:[{type:a,value:"user nginx;\nworker_processes 1;\n\nerror_log \u002Fvar\u002Flog\u002Fnginx\u002Ferror.log warn;\npid \u002Fvar\u002Frun\u002Fnginx.pid;\n\nevents {\nworker_connections 1024;\n}\n\nhttp {\ninclude \u002Fetc\u002Fnginx\u002Fmime.types;\ndefault_type application\u002Foctet-stream;\n\nlog_format main '$remote_addr - $remote_user [$time_local] \"$request\" '\n'$status $body_bytes_sent \"$http_referer\" '\n'\"$http_user_agent\" \"$http_x_forwarded_for\"';\n\naccess_log \u002Fvar\u002Flog\u002Fnginx\u002Faccess.log main;\n\nsendfile on;\n#tcp_nopush on;\n\nkeepalive_timeout 65;\n\n#gzip on;\n\ninclude \u002Fetc\u002Fnginx\u002Fconf.d\u002F*.conf;\n}\n\n"}]}]}]},{type:a,value:c},{type:b,tag:z,props:{},children:[{type:a,value:c},{type:b,tag:p,props:{},children:[{type:a,value:"Trong th∆∞ m·ª•c conf.d ta t·∫°o file\n"},{type:b,tag:d,props:{},children:[{type:a,value:"daotaoyte.edu.vn.conf"}]},{type:b,tag:f,props:{alt:l,src:"https:\u002F\u002Fimages.viblo.asia\u002F58530b94-d979-4db5-968e-62686d341953.png"},children:[]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:t,props:{className:[u]},children:[{type:b,tag:v,props:{className:[w,x]},children:[{type:b,tag:y,props:{},children:[{type:a,value:"server {\nlisten 443 ssl http2;\nlisten [::]:443 ssl http2;\nserver_name daotaoyte.edu.vn www.daotaoyte.edu.vn;\nssl_certificate \u002Fetc\u002Fletsencrypt\u002Flive\u002Fdaotaoyte.edu.vn\u002Ffullchain.pem;\nssl_certificate_key \u002Fetc\u002Fletsencrypt\u002Flive\u002Fdaotaoyte.edu.vn\u002Fprivkey.pem;\n\nssl_session_timeout 5m;\nssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n#ssl_ciphers \"HIGH:!aNULL:!MD5 or HIGH:!aNULL:!MD5:!3DES\";\nssl_prefer_server_ciphers on;\ncharset utf-8;\nroot \u002Fwww\u002Fdaotaoyte.edu.vn;\n\nlocation \u002F {\ntry_files $uri $uri\u002Fhome.html home.html;\n}\nlocation \u002Fmail {\nproxy_pass http:\u002F\u002Flocalhost:5000\u002F;\n}\n\n}\n\n"}]}]}]},{type:a,value:c},{type:b,tag:o,props:{id:L},children:[{type:b,tag:e,props:{href:"#24-t%E1%BA%A1o-file-%C4%91%E1%BB%83-c%E1%BA%A5u-h%C3%ACnh-ssl-https",ariaHidden:g,tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:M}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:"·ªû ƒë√¢y m√¨nh s·∫Ω d√πng 1 script ƒë·ªÉ t·∫°o v√† gia h·∫°n ssl m√¨nh s·∫Ω gi·ªõi thi·ªáu v·ªõi c√°c b·∫°n trong b√†i sau\n"},{type:b,tag:f,props:{alt:"üòÑ",src:"https:\u002F\u002Ftwemoji.maxcdn.com\u002F2\u002F72x72\u002F1f604.png"},children:[]},{type:a,value:".\nB√¢y gi·ªù m√¨nh s·∫Ω x√†i lu√¥n.\n"},{type:b,tag:f,props:{alt:l,src:"https:\u002F\u002Fimages.viblo.asia\u002F172c7ede-bdd1-4645-8bcb-3bbd0e06c96d.png"},children:[]}]},{type:a,value:c},{type:b,tag:o,props:{id:N},children:[{type:b,tag:e,props:{href:"#25-t%E1%BA%A1o-file-build-v%C3%A0-deploy-nginx-tr%C3%AAn-docker",ariaHidden:g,tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:O}]},{type:a,value:c},{type:b,tag:z,props:{},children:[{type:a,value:c},{type:b,tag:p,props:{},children:[{type:a,value:"Sau ƒë√≥ c√°c b·∫°n build file frontend v√† copy file ƒë√≥ v√†o th∆∞ m·ª•c "},{type:b,tag:d,props:{},children:[{type:a,value:"\u002Fmnt\u002Fdata\u002Fww"}]}]},{type:a,value:c},{type:b,tag:p,props:{},children:[{type:a,value:"Ti·∫øp ƒë√≥ ch√∫ng ta ch·ªâ c·∫ßn deploy stacks nginx_proxy b·∫±ng c√°ch l√™n giao di·ªán swarmpit v√† ·∫•n deployl√† xong\n"},{type:b,tag:f,props:{alt:l,src:"https:\u002F\u002Fimages.viblo.asia\u002F46aefe81-bcba-4b5c-92c7-70b18c831f6d.png"},children:[]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:s,props:{id:P},children:[{type:b,tag:e,props:{href:"#3-ki%E1%BB%83m-tra",ariaHidden:g,tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:Q}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:"-V√†o trang web v·ª´a tri·ªÉn khai ki·ªÉm tra th·ª≠\n"},{type:b,tag:f,props:{alt:l,src:"https:\u002F\u002Fimages.viblo.asia\u002F5574c1fc-f9d8-4c62-a29f-6ebcdb1e13fc.png"},children:[]},{type:a,value:"\nCh√∫ng ta ƒë√£ tri·ªÉn khai th√†nh c√¥ng nginx tr√™n c·ª•m docker swarm.\nDo gluster n√™n d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c ƒë·ªìng b·ªô tr√™n c·∫£ 3 server. Ch√∫ng ta tr·ªè IP c·∫£ 3 server v·ªÅ domain nh√©. ƒêi·ªÅu n√†y s·∫Ω gi√∫p\nph√¢n t·∫£i cho server.\nC·∫£m ∆°n c√°c b·∫°n ƒë√£ ƒë·ªçc b√†i vi·∫øt c·ªßa m√¨nh."}]}]},dir:"\u002F2021\u002Fviblo",path:"\u002F2021\u002Fviblo\u002Fdung-nginx-tren-docker-swarm-va-script-de-tao-va-gia-han-ssl-tren-docker-swarm-eW65G4jPKDO",extension:".md",createdAt:"2021-08-10T18:22:56.051Z",updatedAt:"2021-08-10T18:25:13.949Z",readingTime:{text:"3 min read",minutes:2.765,time:165900,words:553},locale:"vi",slugWithoutLocale:q},slug:q,prev:U,next:U}],fetch:{},mutations:void 0}}("text","element","\n","strong","a","img","true",-1,"span","icon","icon-link","image.png","p",3,"h3","li","dung-nginx-tren-docker-swarm-va-script-de-tao-va-gia-han-ssl-tren-docker-swarm-eW65G4jPKDO",2,"h2","div","nuxt-content-highlight","pre","language-text","line-numbers","code","ul","\u002Fmnt\u002Fdata\u002Fceph\u002Fnginx\u002Fetc\u002F","1-m·ªü-ƒë·∫ßu","1. M·ªü ƒë·∫ßu","2-n√†o-ch√∫ng-ta-c√πng-b·∫Øt-ƒë·∫ßu","2. N√†o ch√∫ng ta c√πng b·∫Øt ƒë·∫ßu.","21-tr·ªè-domain-v·ªÅ-ip-c·ªßa-3-server-trong-c·ª•m-swarm","2.1 Tr·ªè domain v·ªÅ IP c·ªßa 3 server trong c·ª•m swarm","22-t·∫°o-container-nginx-tr√™n-docker-swarm","2.2 T·∫°o container Nginx tr√™n docker swarm","23-t·∫°o-file-c·∫•u-h√¨nh-nginx","2.3 T·∫°o file c·∫•u h√¨nh nginx","24-t·∫°o-file-ƒë·ªÉ-c·∫•u-h√¨nh-ssl-https","2.4 T·∫°o file ƒë·ªÉ c·∫•u h√¨nh ssl (https)","25-t·∫°o-file-build-v√†-deploy-nginx-tr√™n-docker","2.5 T·∫°o file build v√† deploy nginx tr√™n docker","3-ki·ªÉm-tra","3. Ki·ªÉm tra","http:\u002F\u002Fipserver:888","\u002Fmn\u002Fdata\u002Fceph\u002Fletsencrypt\u002F"," v√†\n",null)));