__NUXT_JSONP__("/fr/giai-phap-multi-tenancy", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A){return {data:[{post:{slug:i,title:"Giáº£i phÃ¡p multi-tenancy",publishedAt:"2021-08-11 1:26",authors:[{name:"giaosucan",avatarUrl:"https:\u002F\u002Fwww.blogger.com\u002Fimg\u002Favatar_blue_m_96.png",link:o}],tags:["Multi tenancy","Architecture"],private:false,source_post:o,toc:[{id:p,depth:q,text:r},{id:s,depth:q,text:t}],body:{type:"root",children:[{type:b,tag:d,props:{},children:[{type:b,tag:f,props:{alt:"Multi tenant lÃ  gÃ¬? Tá»•ng quan vá» Multi tenancy nhÆ° tháº¿ nÃ o?",src:"https:\u002F\u002Flh3.googleusercontent.com\u002FkggiZzIPZW3Tc5VRTzxNARbUi2-wNPB1eFH9N0t_uK9LEvrWT87pDusNcKdj74BNn1O-ozAsblig78eanRmtwYr4Ffc4HMoNN1jQszsV6ZlTKDtukH6AYgIzm2BC7OXgtUs48rU=w400-h234"},children:[]}]},{type:a,value:c},{type:b,tag:u,props:{id:p},children:[{type:b,tag:g,props:{href:"#1b%C3%A0i-to%C3%A1n",ariaHidden:v,tabIndex:w},children:[{type:b,tag:x,props:{className:[y,z]},children:[]}]},{type:a,value:r}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"XXX lÃ  má»™t startup má»›i ná»•i á»Ÿ Sillicon Valley. Sáº£n pháº©m cá»§a cÃ´ng ty Ä‘Æ°á»£c nhiá»u doanh nghiá»‡p Æ°u chuá»™ng nhá» kháº£ nÄƒng báº£o máº­t cao. Ban Ä‘áº§u cÃ´ng ty váº«n cung cáº¥p sáº£n pháº©m theo cÃ¡ch truyá»n thá»‘ng. Tá»©c lÃ  khi cÃ³ má»™t khÃ¡ch hÃ ng má»›i, gá»i lÃ  1 tenant, Ä‘á»™i SRE sáº½ provison má»™t infra structure trÃªn cloud AWS bao gá»“m (VPC, Server EC2, EBS, Database â€¦) cho riÃªng khÃ¡ch hÃ ng Ä‘Ã³, rá»“i deploy á»©ng dá»¥ng lÃªn infra Ä‘Ã³. Má»—i tenant Ä‘Æ°á»£c launch sáº½ cÃ³ domain riÃªng kiá»ƒu nhÆ° (tenant1.xxx.com, tenant2.xxx.com), má»™t db riÃªng vÃ  má»™t instance cá»§a software. Má»i thá»© Ä‘á»u hoÃ n toÃ n Ä‘á»™c láº­p."}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:b,tag:f,props:{alt:"Single Tenant vs Multi Tenant: SaaS Architecture | Clickittech",src:"https:\u002F\u002Flh6.googleusercontent.com\u002Fe1yM-ouwcQerTOEO0PJBn8g5NB7g70wdt5eILo6KzOiPNlrPyG16Ku0Q5hTJBRGxl2xR_gH5aRAbTClaTu5DAJB79CC0pHxn3AbZuy8_-EEz2Payg-H9lpViKkq0qsGplU3vJqU"},children:[]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"TÃ¹y vÃ o Ä‘á»™ lá»›n cá»§a tá»«ng tenants infrastructure sáº½ cÃ³ má»™t sá»‘ Ä‘iá»u chá»‰nh cho phÃ¹ há»£p. VÃ­ dá»¥ tenant nhá», Ã­t user thÃ¬ sá»­ dá»¥ng 1 server all-in-one duy nháº¥t. Tá»©c lÃ  application, database, services deploy toÃ n bá»™ trong 1 server Ä‘á»ƒ giáº£m cost. CÃ²n tenant lá»›n, nhiá»u users, infra phÃ¡t triá»ƒn thÃ nh cá»¥m cluster server topology, cÃ¡c service nhÆ° hbase, mongo, elk, sáº½ Ä‘Æ°á»£c deploy trÃªn cÃ¡c server riÃªng Ä‘Ã£ giáº£m load cho há»‡ thá»‘ng"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:b,tag:f,props:{alt:h,src:"https:\u002F\u002Flh5.googleusercontent.com\u002FiCAt5AMBP578pdaAwI591aQAF_JEyaTnKYk4BoN5ywZeGyikY502JD67g25HAjAqk50seTKUkaEU-hXxHTXtREfPdtw_YGl17WP6_c9iOuPl5MH923uLILxYRBt6bBSDD3iPDEU"},children:[]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Viá»‡c provisioning infra Ä‘Æ°á»£c thá»±c hiá»‡n hoÃ n toÃ n tá»± Ä‘á»™ng theo 1 flow trong vÃ²ng 2 tiáº¿ng"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Jira ticket approved ğŸ¡ª Jenkins pipeline trigger ğŸ¡ª provisioning infra ğŸ¡ª deploy app"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"CÃ¡ch lÃ m trÃªn cÅ©ng cÃ³ nhiá»u Æ°u Ä‘iá»ƒm khi Ä‘áº£m báº£o Ä‘Æ°á»£c tÃ­nh Ä‘á»™c láº­p, security cho tá»«ng khÃ¡ch hÃ ng, dá»… customize theo yÃªu cáº§u cá»§a há».Tuy nhiÃªn, sau má»™t thá»i gian dÃ i sá»­ dá»¥ng, sá»‘ lÆ°á»£ng khÃ¡ch hÃ ng nhiá»u lÃªn, mÃ´ hÃ¬nh single tenant nÃ y bá»™c lá»™ nhiá»u nhÆ°á»£c Ä‘iá»ƒm"}]},{type:a,value:c},{type:b,tag:j,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"Tá»‘n chi phÃ­, má»—i má»™t khÃ¡ch hÃ ng on-board lÃ  pháº£i deploy má»™t infra riÃªng biá»‡t. Æ¯á»›c tÃ­nh má»™t nÄƒm chi phÃ­ vá» cloud computing lÃªn tá»›i 3M $"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"Kháº£ nÄƒng scaling, do infra lÃ  fix cá»©ng 1 server hoáº·c 1 cá»¥m server, khi khÃ¡ch hÃ ng grown up, server bá»‹ quÃ¡ táº£i. Pháº£i update láº¡i infra"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"Effort báº£o trÃ¬, nhiá»u khÃ¡ch hÃ ng nhiá»u infra nÃªn Ä‘á»™i ngÅ© SRE engineer mÃ¢t ráº¥t nhiá»u effort cho viá»‡c maintained, xá»­ lÃ½ issue request tá»« khÃ¡ch hÃ ng cho tá»«ng infra khÃ¡c nhau"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"Upgrade application tá»‘n kÃ©m kháº£ nhiá»u thá»i gian vÃ  cÃ³ downtime, nguyÃªn nhÃ¢n má»—i khi update application thÃ¬ pháº£i deploy láº¡i luÃ´n cáº£ pháº§n persistent layer (pháº§n Ã­t khi thay Ä‘á»•i)"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:u,props:{id:s},children:[{type:b,tag:g,props:{href:"#1gi%E1%BA%A3i-ph%C3%A1p",ariaHidden:v,tabIndex:w},children:[{type:b,tag:x,props:{className:[y,z]},children:[]}]},{type:a,value:t}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Nháº­n tháº¥y kiáº¿n trÃºc single tenant cÃ³ nhiá»u nhÆ°á»£c Ä‘iá»ƒm, Ä‘á»™i SRE Ä‘Ã£ quyáº¿t Ä‘á»‹nh thá»­ nghiá»‡m kiáº¿n trÃºc "},{type:b,tag:g,props:{href:"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FMultitenancy",rel:[k,l,m],target:n},children:[{type:a,value:"multi-tenancy"}]},{type:a,value:" Ä‘á»ƒ giáº£m chi phÃ­. Má»™t project Ä‘Æ°á»£c Ä‘áº·t biá»‡t danh lÃ  Kronos Ä‘á»ƒ thá»±c hiá»‡n"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"CÃ¡c viá»‡c cáº§n lÃ m lÃ "}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Chuyá»ƒn Ä‘á»•i toÃ n bá»™ pháº§n backend tá»« monolithic sang kiáº¿n trÃºc microservice, containerized thÃ nh docker image Ä‘á»ƒ cÃ³ thá»ƒ deploy tá»« server truyá»n thá»‘ng sang ná»n táº£ng K8S, ECS cÃ³ kháº£ nÄƒng autoscale tá»‘t hÆ¡n"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"CÃ¡c service nhÆ° hbase, mongo, elk cháº¡y á»Ÿ táº§ng persistence sáº½ Ä‘Æ°á»£c dÃ¹ng chung cho má»i tenant"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Chuyá»ƒn Ä‘á»•i infra tá»« EC2, Cluster sang K8S vÃ  ECS"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:b,tag:f,props:{alt:h,src:"https:\u002F\u002Flh3.googleusercontent.com\u002FDyN3X_8LzuXoB1k_Fud_2AxAkZUbNIeSnjnd_Pm2L46TLeTNvM39W9n9o75zX7oFFbpw8aRYFdQA2AVYC89s1sQFCDSEIQnZMYyHsbZVbCl3rVXVqE3-eKEls7C-3vzlgGNsKl4"},children:[]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Pháº§n persistent layer sáº½ Ä‘Æ°á»£c deploy lÃªn server EC2 Ä‘á»ƒ sá»­ dá»¥ng chung cho toÃ n bá»™ tenant. CÃ¡c tenant lÃ  nÆ¡i Ä‘eploy á»©ng dung cÃ¡c microservice business logic. Microservice Ä‘Æ°á»£c build thÃ nh docker vÃ  deploy lÃªn ECS nÃªn leverage Ä‘Æ°á»£c kháº£ nÄƒng autoscaling."}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"CÃ¡ch lÃ m nÃ y Ä‘em láº¡i khÃ¡ nhiá»u Æ°u Ä‘iá»ƒm"}]},{type:a,value:c},{type:b,tag:j,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"Chi phÃ­ Ä‘Ã£ giáº£m Ä‘i tá»›i 30% do pháº§n persistent layer Ä‘Æ°á»£c chuyá»ƒn sang dÃ¹ng chung"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"Autoscaling vÃ¬ Ä‘Ã£ chuyá»ƒn tá»« server truyá»n thá»‘ng sang ECS"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"Viá»‡c upgrade thá»±c hiá»‡n nhanh hÆ¡n vÃ¬ má»—i khi upgrade thÃ¬ chá»‰ cáº§n upgrade pháº§n microservice trÃªn ECS, cÃ¡c service deploy Ä‘á»™c láº­p nÃªn háº¡n cháº¿ downtime"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Tuy nhiÃªn, má»™t khÃ³ khÄƒn mÃ  Ä‘á»™i dá»± Ã¡n gáº·p pháº£i Ä‘Ã³ lÃ  pháº§n database."}]},{type:a,value:c},{type:b,tag:j,props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"VÃ¬ tenant dÃ¹ng chung database nÃªn lÃ m sao cÃ³ thá»ƒ Ä‘áº£m báº£o data cá»§a tá»«ng tenant pháº£i isolation vÃ  security"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"Nhiá»u tenant nÃªn dá»¯ liá»‡u tÄƒng lÃªn ráº¥t nhanh, pháº£i autoscaling nhÆ° tháº¿ nÃ o"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Äá»™i dá»± Ã¡n quyáº¿t Ä‘á»‹nh sá»­ dá»¥ng "},{type:b,tag:g,props:{href:"https:\u002F\u002Fwww.mongodb.com\u002Fcloud\u002Fatlas\u002Flp\u002Ftry2?utm_source=google&utm_campaign=gs_apac_vietnam_search_core_brand_atlas_desktop&utm_term=mongo%20atlas&utm_medium=cpc_paid_search&utm_ad=e&utm_ad_campaign_id=12212624377&gclid=Cj0KCQjw6ZOIBhDdARIsAMf8YyFyaEhT5r95RA-sfCUBHT3bLjkCn8zfG_ohSUyRXUXMowRHD-GGnm8aAl0wEALw_wcB",rel:[k,l,m],target:n},children:[{type:a,value:"mongo atlas"}]},{type:a,value:" Cloud-hosted MongoDB service on AWS thay vÃ¬ tá»± deploy trÃªn EC2, do tháº¿ máº¡nh vá» scaling, auto healing"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:b,tag:f,props:{alt:h,src:"https:\u002F\u002Flh5.googleusercontent.com\u002Flh2LlqNdREWX7CrOSgFAXYAZoN8jUOB6rAfiC6TXcPCwThQKNcr3tIm_DGgYFOXeAIWqK5Gxo11io0DCQ30bCJxfMdgGRrhRlFYgnpdJX_OF5MxFg5ERv-51SU3wXdTP_mUSF-w"},children:[]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Má»™t database "},{type:b,tag:g,props:{href:"https:\u002F\u002Fhelp.cloud66.com\u002Fmaestro\u002Fthe-basics\u002Fabout-maestro.html",rel:[k,l,m],target:n},children:[{type:a,value:"maestro"}]},{type:a,value:" chung Ä‘Æ°á»£c táº¡o chuyÃªn Ä‘á»ƒ quáº£n lÃ½ danh sÃ¡ch tenant nhÆ° id, user, role, vÃ  má»—i tenant sáº½ cÃ³ 1 database riÃªng deploy trong mongo atlas cluster. Má»—i db cÃ³ credential riÃªng vÃ  rotate 3 thÃ¡ng má»™t láº§n, Ä‘áº£m báº£o service cá»§a tenant A khÃ´ng thá»ƒ truy cáº­p vÃ o database cá»§a tenant B"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:b,tag:f,props:{alt:h,src:"https:\u002F\u002Flh5.googleusercontent.com\u002F5uOBtI3fNJOSVa76yLaj_nkKBvn8lYVqCcMX5xu6f-GY6zwMugOV_GzbP6fhrCWW5I6fUlxoEgv8KmvWCc0dXZGClYJvn_LHunwi9JzNYoUAdOBAQj_QA5urXXOBLGrYYdk4_Q4"},children:[]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Sau khi giáº£i phÃ¡p multi-tenancy Ä‘Æ°á»£c Ä‘Æ°a vÃ o thá»­ nghiá»‡m, káº¿t quáº£ trong 1 nÄƒm Ä‘áº¡t hiá»ƒu quáº£ khÃ¡ tá»‘t khi cost Ä‘Ã£ giáº£m Ä‘Æ°á»£c tá»›i 30%"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"BÃ i toÃ¡n vá» cost Ä‘Æ°á»£c cÃ¡c lÃ£nh Ä‘áº¡o háº¿t sá»©c quan tÃ¢m, sau khi kÃ­ Ä‘Æ°á»£c deal vá»›i GCP, cÃ´ng ty XXX Ä‘Æ°á»£c phÃ­a Google offer má»™t má»©c giÃ¡ ráº» hÆ¡n cho vá»›i AWS lÃªn tá»›i 30%, cam káº¿t sá»­ dá»¥ng dá»‹ch vá»¥ trong vÃ²ng 5 nÄƒm."}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Má»™t bÃ i toÃ¡n Ä‘áº·t ra Ä‘á»‘i vá»›i Ä‘á»™i SRE, cáº§n migrate toÃ n bá»™ infra hiá»‡n táº¡i trÃªn AWS sang GCP."}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"ÄÃ³ Ä‘á»c cÃ¡c pháº§n tiáº¿p theo"}]}]},dir:"\u002F2021\u002Fviblo",path:"\u002F2021\u002Fviblo\u002Fgiai-phap-multi-tenancy",extension:".md",createdAt:"2021-08-10T18:26:11.026Z",updatedAt:"2021-08-10T18:30:18.923Z",readingTime:{text:"5 min read",minutes:4.315,time:258900,words:863},locale:"vi",slugWithoutLocale:i},slug:i,prev:A,next:A}],fetch:{},mutations:void 0}}("text","element","\n","p","li","img","a","","giai-phap-multi-tenancy","ul","nofollow","noopener","noreferrer","_blank","https:\u002F\u002Fwww.giaosucan.com\u002F2021\u002F08\u002Fgiai-phap-multi-tenancy.html","1bÃ i-toÃ¡n",3,"1.BÃ i toÃ¡n","1giáº£i-phÃ¡p","1.Giáº£i phÃ¡p","h3","true",-1,"span","icon","icon-link",null)));